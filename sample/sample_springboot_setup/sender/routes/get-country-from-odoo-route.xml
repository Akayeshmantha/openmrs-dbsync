<routes xmlns="http://camel.apache.org/schema/spring">
  <route id="get-country-from-odoo">
    <from uri="direct:get-country-from-odoo"/>
    <setProperty propertyName="address-array">
      <simple>${body}</simple>
    </setProperty>
    <setBody>
      <simple>${null}</simple>
    </setBody>
    <!--Get country from Odoo based on the name entered in OpenMrs-->
    <toD uri="http://192.168.50.193:8069/api/res.country?domain=[('name','=','${property.address-array[4]}')]&amp;httpClient.cookiePolicy=ignoreCookies"/>
    <transform>
      <jsonpath>$.data[0].id</jsonpath>
    </transform>
    <!--Replace country name with ID returned from above query-->
    <transform>
      <simple>${property.address-array.add(5,${body})}</simple>
    </transform>
    <transform>
      <simple>${property.address-array.remove(4)}</simple>
    </transform>
    <setBody>
      <simple>${property.address-array}</simple>
    </setBody>
  </route>
</routes>
